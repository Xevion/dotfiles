# OpenCode-Specific Guidelines

## Question Tool Constraints

**CRITICAL: The Question tool has strict character limits. Violating them causes tool failures.**

| Field   | Max Length | Guidance                        |
| ------- | ---------- | ------------------------------- |
| `header`  | 30 chars   | Very short label only           |
| `label`   | 30 chars   | 1-5 words, like button text     |
| `description` | unlimited  | Put all detail here         |

### Labels Are Button Text, Not Descriptions

**WRONG** - these WILL fail:
```
"Simple perpendicular distance (Recommended)"  // 41 chars
"Treat as failure then clearRoute()"           // 35 chars
```

**CORRECT** - terse labels, detail in description:
```
"Perpendicular distance"     // 22 chars - put "(Recommended)" in description instead
"Fail and clear route"       // 20 chars
```

### The "(Recommended)" Trap

The system prompt says to add "(Recommended)" to labels, but that's **14 characters** - leaving only 16 for actual content. Instead:

1. **Put recommended option FIRST** in the list (as instructed)
2. **Add "(Recommended)" to the description**, not the label
3. Or use a short marker like `[Rec]` (5 chars) if you must mark the label

### Before Submitting Questions

Mentally count characters for each `header` and `label`. If it looks longer than a short button label, it's too long. Move the detail to `description`.

## Multiple-Select Configuration

**CRITICAL: Set `multiple: true` by default. Only use `multiple: false` when options are mutually exclusive.**

When you ask a question with multiple options, the user should be able to pick more than one UNLESS the options fundamentally conflict. Most questions allow multiple selections.

**Examples requiring `multiple: true` (DEFAULT):**
- "Which features should I add?" → User might want several features
- "What validations should I include?" → Multiple validations make sense
- "Which files need this change?" → Often applies to multiple files

**Examples requiring `multiple: false` (RARE):**
- "Use sync or async approach?" → Cannot be both
- "Overwrite file or merge changes?" → Conflicting actions

**If you're presenting A, B, C options and don't set `multiple: true`, you're likely doing it wrong.**

## Explore Agent Override

The `explore` subagent uses `anthropic/claude-haiku-4-5` (a fast but limited model). **Do NOT delegate anything requiring reasoning to it.** See the "Subagent and Tool Selection" decision matrix in the shared rules below for when to use which tool/agent.

**Reinforcement:** If you can answer a question with Read, Glob, or Grep in 1-3 calls, do that directly. Only use Explore for bulk operations across many files where formatting the output is the main value.

---

{{ template "common-rules.md.tmpl" . }}
