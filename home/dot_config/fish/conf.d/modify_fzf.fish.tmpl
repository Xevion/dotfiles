#!/usr/bin/env bun

// Modify fzf.fish to disable default CTRL+R binding (allow Atuin to handle it)
// This is a chezmoi modify_ script that processes fzf.fish on every apply

const content = await Bun.stdin.text();
const lines = content.split('\n');

// Find and comment out the standalone fzf_configure_bindings call
const targetLineRegex = /^(\s*)fzf_configure_bindings\s*$/;

const modifiedLines = lines.map(line => {
  if (targetLineRegex.test(line) && !line.trim().startsWith('#')) {
    const indent = line.match(/^(\s*)/)?.[1] || '';
    return `${indent}# fzf_configure_bindings  # Disabled - configured in config.fish instead`;
  }
  return line;
});

console.log(modifiedLines.join('\n'));
